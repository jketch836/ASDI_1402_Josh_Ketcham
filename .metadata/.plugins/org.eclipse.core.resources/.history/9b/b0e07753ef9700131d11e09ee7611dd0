var db = Ti.Database.open('contact');
var sData = Ti.App.Properties.getString('sData');
db.execute('CREATE TABLE IF NOT EXISTS contact (id INTEGER PRIMARY KEY, fname TEXT, email TEXT, age INTEGER, phone INTEGER)');

var info = [];

var dataRows = db.execute('SELECT * FROM contact');

// Ti.API.debug("Data rows:" + dataRows.getFieldName(1));
// Ti.API.debug("Data rows:" + dataRows.getFieldName(2));
// Ti.API.debug("Data rows:" + dataRows.getFieldName(3));
// Ti.API.debug("Data rows:" + dataRows.getFieldName(4));

while (dataRows.isValidRow()) {
	var fName = dataRows.fieldByName('fName');
	var email = dataRows.fieldByName('email');	
	var age = dataRows.fieldByName('age');
	var phone = dataRows.fieldByName('phone');
	
	info.push({
		title: dataRows.fName,
		id: dataRows.fieldByName('id')
	});
	console.log(email);
	dataRows.next();
};
dataRows.close();
// console.log(dataRows);


var mainWin = Ti.UI.createWindow({
	title: 'Contacts',
	backgroundColor: '#fff'
});

var nWin = Ti.UI.iOS.createNavigationWindow({
	window: mainWin
});


var addContact = Ti.UI.createButton({
	height: '15dp',
	width:  '15dp',
	backgroundImage: 'add.png'
});
mainWin.setRightNavButton(addContact);

addContact.addEventListener('click', function(){
var addContacts = require('addContact');
});


var tableData = Ti.UI.createTableView({
	top: 0,
	data: info,
	editable: true
});
tableData.setData(info);

tableData.addEventListener('click', function(a){
//Get stored data in dataRows
var presentRow = db.execute('SELECT * fROM contact WHERE id=?', a.dataRows.id);

	var id = presentRow.fieldByName('id');
	var fName = presentRow.fieldByName('fName');
	var age = presentRow.fieldByName('age');
	var phone = presentRow.fieldByName('phone');
	var email = presentRow.fieldByName('email');
	
var ContactWin = Ti.UI.createWindow({
	title: fName,
	backgroundColor: '#F8F8FF'
});		


		// var editBTN = Ti.UI.createButton({
			// title: "Edit",
			// style: Ti.UI.iPhone.SystemButtonStyle.DONE,
			// font:{fontWeight:'bold',fontSize:10, fontFamily:'Helvetica'},
		// });
		// mainWin.setLeftNavButton(editBTN);
// 		
		// editBTN.addEventListener('click', function(b){
			// var editContact = require('editContact');
		// });
});


//Main Code
mainWin.add(tableData);
nWin.open();